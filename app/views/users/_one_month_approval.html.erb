<% provide(:class_text, 'approval') %>
<% provide(:button_text, '更新') %>

<%= form_with(model: @user, url: attendance_monthly_reports_update_all_user_path(), local: true, method: :patch) do |f| %>
  <div class="modal-dialog modal-lg modal-dialog-center">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">×</button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-10 col-md-offset-1">
            <% @one_month_approvals.each do |user_separate_approvals| %>
              <div class="title-text-approval">【<%= user_separate_approvals.first.user_name %>からの１ヵ月分勤怠申請】</div>
              <table class="table table-bordered table-condensed table-hover" id="table-attendances">
                <thead>
                  <th>月</th>
                  <th>指示者確認㊞</th>
                  <th>変更</th>
                  <th>勤怠を確認する</th>
                </thead>
                <tbody>
                  <% user_separate_approvals.each do |approval| %>
                    <%= f.fields_for "approvals[]", approval do |approval_check| %>
                      <tr>
                        <td><%= l(approval.month, format: :middle) %></td>
                        <td>
                          <%= approval_check.select :decision, $decision_word,
                          {selected: decision_to_display(approval.decision)},
                          {class: "form-control"} %>
                        </td>
                        <td> 
                          <%= approval_check.check_box(:change_flag, {checked: false, class: ""}, checked_value = true, unchecked_value = false ) %>
                        </td>
                        <td>
                          <%= link_to "確認", attendances_preview_user_path(approval.user), class: "btn btn-primary", target: :_blank %>
                        </td>
                      </tr>
                    <% end %>
                  <% end %>
                </tbody>
              </table>
            <% end %>
            <%= f.submit "変更を送信する", class: "btn btn-primary col-md-4 col-md-offset-4" %>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>